2025-03-07 14:42:18,171 - MainThread - sqlmesh.core.config.scheduler - WARNING - The bigquery engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:112)
2025-03-07 14:42:26,865 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "formulaone-448910".sqlmesh__staging (evaluator.py:316)
2025-03-07 14:42:26,869 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH `clustering_info` AS (SELECT `table_catalog`, `table_schema`, `table_name`, STRING_AGG(`column_name` ORDER BY `clustering_ordinal_position`) AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.COLUMNS` AS `COLUMNS` WHERE `clustering_ordinal_position` IS NOT NULL GROUP BY 1, 2, 3) SELECT `table_catalog` AS `catalog`, `table_name` AS `name`, `table_schema` AS `schema_name`, CASE WHEN `table_type` = 'BASE TABLE' THEN 'TABLE' WHEN `table_type` = 'CLONE' THEN 'TABLE' WHEN `table_type` = 'EXTERNAL' THEN 'TABLE' WHEN `table_type` = 'SNAPSHOT' THEN 'TABLE' WHEN `table_type` = 'VIEW' THEN 'VIEW' WHEN `table_type` = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE `table_type` END AS `type`, `ci`.`clustering_key` AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.TABLES` AS `TABLES` LEFT JOIN `clustering_info` AS `ci` USING (`table_catalog`, `table_schema`, `table_name`) WHERE `table_name` IN ('staging__stg_constructors__4250999878', 'staging__stg_circuits__3713804988') (base.py:2079)
2025-03-07 14:42:29,002 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"formulaone-448910".sqlmesh__staging' (evaluator.py:1044)
2025-03-07 14:42:29,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `formulaone-448910`.`sqlmesh__staging` (base.py:2079)
2025-03-07 14:42:30,080 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table '"formulaone-448910".sqlmesh__staging.staging__stg_constructors__4250999878' (evaluator.py:1349)
2025-03-07 14:42:30,080 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__4250999878` OPTIONS (description='The constructors that race in the Formula One') AS SELECT CAST(`constructorid` AS STRING) AS `id_constructor`, `name` AS `constructor_name`, `nationality` AS `nationality`, `url` AS `url` FROM `formulaone-448910`.`raw_data`.`Constructors` AS `constructors` WHERE FALSE LIMIT 0 (base.py:2079)
2025-03-07 14:42:33,250 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Registering column comments for table "formulaone-448910".sqlmesh__staging.staging__stg_constructors__4250999878 (bigquery.py:685)
2025-03-07 14:42:34,989 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__snapshots_c1w1umfe (bigquery.py:466)
2025-03-07 14:42:42,732 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"formulaone-448910"."staging"."stg_circuits": 3100381266> (evaluator.py:577)
2025-03-07 14:42:43,189 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-01-25 00:00:00, 2025-03-07 00:00:00) into "formulaone-448910".sqlmesh__staging.staging__stg_circuits__3713804988' (evaluator.py:608)
2025-03-07 14:42:43,347 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE `formulaone-448910`.`sqlmesh__staging`.`staging__stg_circuits__3713804988` (`id_circuit` STRING OPTIONS (description='Unique identifier for the circuit'), `circuit_name` STRING OPTIONS (description='Name of the circuit'), `circuit_url` STRING OPTIONS (description='Wikipedia URL of the circuit'), `country` STRING OPTIONS (description='Country in which the circuit is located'), `latitude` STRING OPTIONS (description='latitude of the circuit'), `locality` STRING OPTIONS (description='Name of the locality associated to the circuit'), `longitude` STRING OPTIONS (description='longitude of the circuit')) OPTIONS (description='The circuits used by the Formula One') AS SELECT CAST(`id_circuit` AS STRING) AS `id_circuit`, CAST(`circuit_name` AS STRING) AS `circuit_name`, CAST(`circuit_url` AS STRING) AS `circuit_url`, CAST(`country` AS STRING) AS `country`, CAST(`latitude` AS STRING) AS `latitude`, CAST(`locality` AS STRING) AS `locality`, CAST(`longitude` AS STRING) AS `longitude` FROM (SELECT CAST(`circuitid` AS STRING) AS `id_circuit`, CAST(`circuitname` AS STRING) AS `circuit_name`, CAST(`url` AS STRING) AS `circuit_url`, JSON_VALUE(`location`, '$.country') AS `country`, JSON_VALUE(`location`, '$.lat') AS `latitude`, JSON_VALUE(`location`, '$.locality') AS `locality`, JSON_VALUE(`location`, '$.long') AS `longitude` FROM `formulaone-448910`.`raw_data`.`Circuits` AS `circuits`) AS `_subquery` (base.py:2079)
2025-03-07 14:42:46,313 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2025-01-25 00:00:00, 2025-03-07 00:00:00) for snapshot SnapshotId<"formulaone-448910"."staging"."stg_circuits": 3100381266> (engine_adapter.py:1031)
2025-03-07 14:42:46,573 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__intervals_78qqe2pr (bigquery.py:466)
2025-03-07 14:42:51,962 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"formulaone-448910"."staging"."stg_constructors": 1652004732> (evaluator.py:577)
2025-03-07 14:42:52,567 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-01-25 00:00:00, 2025-03-07 00:00:00) into "formulaone-448910".sqlmesh__staging.staging__stg_constructors__4250999878' (evaluator.py:608)
2025-03-07 14:42:52,809 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__4250999878` (`id_constructor` STRING OPTIONS (description='Unique identifier for the constructor'), `constructor_name` STRING OPTIONS (description='Properly formatted name of the constructor'), `nationality` STRING OPTIONS (description='The nationality of the constructor'), `url` STRING OPTIONS (description='The Wikipedia URL of the constructor')) OPTIONS (description='The constructors that race in the Formula One') AS SELECT CAST(`id_constructor` AS STRING) AS `id_constructor`, CAST(`constructor_name` AS STRING) AS `constructor_name`, CAST(`nationality` AS STRING) AS `nationality`, CAST(`url` AS STRING) AS `url` FROM (SELECT CAST(`constructorid` AS STRING) AS `id_constructor`, `name` AS `constructor_name`, `nationality` AS `nationality`, `url` AS `url` FROM `formulaone-448910`.`raw_data`.`Constructors` AS `constructors`) AS `_subquery` (base.py:2079)
2025-03-07 14:42:55,350 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2025-01-25 00:00:00, 2025-03-07 00:00:00) for snapshot SnapshotId<"formulaone-448910"."staging"."stg_constructors": 1652004732> (engine_adapter.py:1031)
2025-03-07 14:42:55,596 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__intervals_pakc6uq2 (bigquery.py:466)
2025-03-07 14:43:01,911 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'dev' (engine_adapter.py:280)
2025-03-07 14:43:05,466 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__environments_6kjup2lv (bigquery.py:466)
2025-03-07 14:43:12,700 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"formulaone-448910".staging__dev' (evaluator.py:1044)
2025-03-07 14:43:12,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `formulaone-448910`.`staging__dev` (base.py:2079)
2025-03-07 14:43:14,881 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging__dev.stg_circuits' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_circuits__3713804988' (evaluator.py:1315)
2025-03-07 14:43:14,881 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging__dev`.`stg_circuits` AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_circuits__3713804988` (base.py:2079)
2025-03-07 14:43:16,157 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging__dev.stg_constructors' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_constructors__4250999878' (evaluator.py:1315)
2025-03-07 14:43:16,158 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging__dev`.`stg_constructors` AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__4250999878` (base.py:2079)
2025-03-07 14:43:17,263 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'dev' (engine_adapter.py:405)
2025-03-07 14:43:21,393 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
