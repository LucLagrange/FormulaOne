2025-03-07 15:12:23,354 - MainThread - sqlmesh.core.config.scheduler - WARNING - The bigquery engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:112)
2025-03-07 15:13:13,697 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "formulaone-448910".sqlmesh__staging (evaluator.py:316)
2025-03-07 15:13:13,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH `clustering_info` AS (SELECT `table_catalog`, `table_schema`, `table_name`, STRING_AGG(`column_name` ORDER BY `clustering_ordinal_position`) AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.COLUMNS` AS `COLUMNS` WHERE `clustering_ordinal_position` IS NOT NULL GROUP BY 1, 2, 3) SELECT `table_catalog` AS `catalog`, `table_name` AS `name`, `table_schema` AS `schema_name`, CASE WHEN `table_type` = 'BASE TABLE' THEN 'TABLE' WHEN `table_type` = 'CLONE' THEN 'TABLE' WHEN `table_type` = 'EXTERNAL' THEN 'TABLE' WHEN `table_type` = 'SNAPSHOT' THEN 'TABLE' WHEN `table_type` = 'VIEW' THEN 'VIEW' WHEN `table_type` = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE `table_type` END AS `type`, `ci`.`clustering_key` AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.TABLES` AS `TABLES` LEFT JOIN `clustering_info` AS `ci` USING (`table_catalog`, `table_schema`, `table_name`) WHERE `table_name` IN ('staging__stg_drivers__2303298743', 'staging__stg_constructors__469623500', 'staging__stg_circuits__622503816') (base.py:2079)
2025-03-07 15:13:15,928 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"formulaone-448910".sqlmesh__staging' (evaluator.py:1044)
2025-03-07 15:13:15,929 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `formulaone-448910`.`sqlmesh__staging` (base.py:2079)
2025-03-07 15:13:16,811 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view '"formulaone-448910".sqlmesh__staging.staging__stg_drivers__2303298743' (evaluator.py:1788)
2025-03-07 15:13:16,815 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW `formulaone-448910`.`sqlmesh__staging`.`staging__stg_drivers__2303298743` OPTIONS (description='The drivers that race in the Formula One Championship') AS SELECT CAST(`driverid` AS STRING) AS `id_driver`, `url` AS `driver_url`, `code` AS `driver_code`, `givenname` AS `first_name`, `familyname` AS `last_name`, CAST(`dateofbirth` AS DATE) AS `dt_birth`, `nationality` AS `nationality`, `permanentnumber` AS `driver_number` FROM `formulaone-448910`.`raw_data`.`Drivers` AS `drivers` (base.py:2079)
2025-03-07 15:13:17,490 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Registering column comments for table "formulaone-448910".sqlmesh__staging.staging__stg_drivers__2303298743 (bigquery.py:685)
2025-03-07 15:13:18,440 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__snapshots_h1llq0s9 (bigquery.py:466)
2025-03-07 15:13:25,630 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"formulaone-448910"."staging"."stg_constructors": 3218707511> (evaluator.py:577)
2025-03-07 15:13:25,875 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-01-25 00:00:00, 2025-03-07 00:00:00) into "formulaone-448910".sqlmesh__staging.staging__stg_constructors__469623500' (evaluator.py:608)
2025-03-07 15:13:25,875 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view '"formulaone-448910".sqlmesh__staging.staging__stg_constructors__469623500' (evaluator.py:1742)
2025-03-07 15:13:25,876 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__469623500` (`id_constructor` OPTIONS (description='Unique identifier for the constructor'), `constructor_name` OPTIONS (description='Properly formatted name of the constructor'), `constructor_url` OPTIONS (description='The Wikipedia URL of the constructor'), `nationality` OPTIONS (description='The nationality of the constructor')) OPTIONS (description='The constructors that race in the Formula One Championship') AS SELECT CAST(`constructorid` AS STRING) AS `id_constructor`, `name` AS `constructor_name`, `url` AS `constructor_url`, `nationality` AS `nationality` FROM `formulaone-448910`.`raw_data`.`Constructors` AS `constructors` (base.py:2079)
2025-03-07 15:13:26,698 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2025-01-25 00:00:00, 2025-03-07 00:00:00) for snapshot SnapshotId<"formulaone-448910"."staging"."stg_constructors": 3218707511> (engine_adapter.py:1031)
2025-03-07 15:13:26,961 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__intervals_07ydu3kf (bigquery.py:466)
2025-03-07 15:13:34,911 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"formulaone-448910"."staging"."stg_drivers": 1807623903> (evaluator.py:577)
2025-03-07 15:13:35,312 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-01-25 00:00:00, 2025-03-07 00:00:00) into "formulaone-448910".sqlmesh__staging.staging__stg_drivers__2303298743' (evaluator.py:608)
2025-03-07 15:13:35,312 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view '"formulaone-448910".sqlmesh__staging.staging__stg_drivers__2303298743' (evaluator.py:1742)
2025-03-07 15:13:35,314 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`sqlmesh__staging`.`staging__stg_drivers__2303298743` (`id_driver` OPTIONS (description='Unique identifier for the driver'), `driver_url` OPTIONS (description='URL associated with the driver'), `driver_code` OPTIONS (description='Code representing the driver'), `first_name` OPTIONS (description='Drivers first name'), `last_name` OPTIONS (description='Drivers last name'), `dt_birth` OPTIONS (description='Drivers date of birth'), `nationality` OPTIONS (description='Drivers nationality'), `driver_number` OPTIONS (description='Drivers permanent number')) OPTIONS (description='The drivers that race in the Formula One Championship') AS SELECT CAST(`driverid` AS STRING) AS `id_driver`, `url` AS `driver_url`, `code` AS `driver_code`, `givenname` AS `first_name`, `familyname` AS `last_name`, CAST(`dateofbirth` AS DATE) AS `dt_birth`, `nationality` AS `nationality`, `permanentnumber` AS `driver_number` FROM `formulaone-448910`.`raw_data`.`Drivers` AS `drivers` (base.py:2079)
2025-03-07 15:13:35,965 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (2025-01-25 00:00:00, 2025-03-07 00:00:00) for snapshot SnapshotId<"formulaone-448910"."staging"."stg_drivers": 1807623903> (engine_adapter.py:1031)
2025-03-07 15:13:36,291 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__intervals_f2lldurd (bigquery.py:466)
2025-03-07 15:13:43,303 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'dev' (engine_adapter.py:280)
2025-03-07 15:13:49,396 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__environments_xp91b54q (bigquery.py:466)
2025-03-07 15:13:55,873 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"formulaone-448910".staging__dev' (evaluator.py:1044)
2025-03-07 15:13:55,874 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `formulaone-448910`.`staging__dev` (base.py:2079)
2025-03-07 15:13:56,259 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging__dev.stg_circuits' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_circuits__622503816' (evaluator.py:1315)
2025-03-07 15:13:56,259 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging__dev`.`stg_circuits` AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_circuits__622503816` (base.py:2079)
2025-03-07 15:13:57,115 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging__dev.stg_constructors' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_constructors__469623500' (evaluator.py:1315)
2025-03-07 15:13:57,115 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging__dev`.`stg_constructors` AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__469623500` (base.py:2079)
2025-03-07 15:13:57,824 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging__dev.stg_drivers' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_drivers__2303298743' (evaluator.py:1315)
2025-03-07 15:13:57,824 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging__dev`.`stg_drivers` AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_drivers__2303298743` (base.py:2079)
2025-03-07 15:13:58,558 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'dev' (engine_adapter.py:405)
2025-03-07 15:14:02,047 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
