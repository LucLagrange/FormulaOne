2025-03-07 14:44:08,474 - MainThread - sqlmesh.core.config.scheduler - WARNING - The bigquery engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:112)
2025-03-07 14:44:19,216 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "formulaone-448910".sqlmesh__staging (evaluator.py:316)
2025-03-07 14:44:19,220 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH `clustering_info` AS (SELECT `table_catalog`, `table_schema`, `table_name`, STRING_AGG(`column_name` ORDER BY `clustering_ordinal_position`) AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.COLUMNS` AS `COLUMNS` WHERE `clustering_ordinal_position` IS NOT NULL GROUP BY 1, 2, 3) SELECT `table_catalog` AS `catalog`, `table_name` AS `name`, `table_schema` AS `schema_name`, CASE WHEN `table_type` = 'BASE TABLE' THEN 'TABLE' WHEN `table_type` = 'CLONE' THEN 'TABLE' WHEN `table_type` = 'EXTERNAL' THEN 'TABLE' WHEN `table_type` = 'SNAPSHOT' THEN 'TABLE' WHEN `table_type` = 'VIEW' THEN 'VIEW' WHEN `table_type` = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE `table_type` END AS `type`, `ci`.`clustering_key` AS `clustering_key` FROM `formulaone-448910`.`sqlmesh__staging`.`INFORMATION_SCHEMA.TABLES` AS `TABLES` LEFT JOIN `clustering_info` AS `ci` USING (`table_catalog`, `table_schema`, `table_name`) WHERE `table_name` IN ('staging__stg_circuits__3713804988', 'staging__stg_constructors__4250999878') (base.py:2079)
2025-03-07 14:44:21,758 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:280)
2025-03-07 14:44:28,415 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Loading dataframe to BigQuery. Table Path: /projects/formulaone-448910/datasets/sqlmesh/tables/__temp__environments_anrmyz2q (bigquery.py:466)
2025-03-07 14:44:35,786 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"formulaone-448910"."staging"."stg_circuits": 3100381266> (engine_adapter.py:457)
2025-03-07 14:44:35,786 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"formulaone-448910"."staging"."stg_constructors": 1652004732> (engine_adapter.py:457)
2025-03-07 14:44:38,439 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"formulaone-448910".staging' (evaluator.py:1044)
2025-03-07 14:44:38,439 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `formulaone-448910`.`staging` (base.py:2079)
2025-03-07 14:44:39,034 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging.stg_circuits' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_circuits__3713804988' (evaluator.py:1315)
2025-03-07 14:44:39,035 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging`.`stg_circuits` OPTIONS (description='The circuits used by the Formula One') AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_circuits__3713804988` (base.py:2079)
2025-03-07 14:44:39,753 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Registering column comments for table "formulaone-448910".staging.stg_circuits (bigquery.py:685)
2025-03-07 14:44:40,089 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"formulaone-448910".staging.stg_constructors' to point at table '"formulaone-448910".sqlmesh__staging.staging__stg_constructors__4250999878' (evaluator.py:1315)
2025-03-07 14:44:40,090 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW `formulaone-448910`.`staging`.`stg_constructors` OPTIONS (description='The constructors that race in the Formula One') AS SELECT * FROM `formulaone-448910`.`sqlmesh__staging`.`staging__stg_constructors__4250999878` (base.py:2079)
2025-03-07 14:44:40,826 - MainThread - sqlmesh.core.engine_adapter.bigquery - INFO - Registering column comments for table "formulaone-448910".staging.stg_constructors (bigquery.py:685)
2025-03-07 14:44:41,072 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropping view '"formulaone-448910".staging.stg_circuit' (evaluator.py:1325)
2025-03-07 14:44:41,073 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS `formulaone-448910`.`staging`.`stg_circuit` (base.py:2079)
2025-03-07 14:44:41,733 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:405)
2025-03-07 14:44:45,557 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
